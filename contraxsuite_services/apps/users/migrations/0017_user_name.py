# Generated by Django 2.2.13 on 2020-11-16 16:58

from django.db import migrations


def get_full_name(self):
    """
    Returns the first_name plus the last_name, with a space in between
    or username
    """
    if self.name:
        return self.name
    if self.first_name and self.last_name:
        full_name = '%s %s' % (self.first_name, self.last_name)
        return full_name.strip()
    return self.username


def migrate(apps, schema_editor):
    User = apps.get_model('users', 'User')
    for user in User.objects.all():
        user.name = get_full_name(user)
        user.save()


class Migration(migrations.Migration):

    dependencies = [
        ('users', '0016_user_origin'),
    ]

    operations = [
        migrations.RunPython(migrate, reverse_code=migrations.RunPython.noop)
    ]
