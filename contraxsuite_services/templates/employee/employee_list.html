{% extends "base_list_ajax.html" %}
{% load static %}

{% block js_extra %}
  {{ block.super }}
  <script type="text/javascript">
    $(document).ready(function () {
      var datafields = [
        { name: 'pk', type: 'int' },
        { name: 'document__name', type: 'string' },
        { name: 'document__document_type', type: 'string' },
        { name: 'document__description', type: 'string' },
        { name: 'name', type: 'string' },
        { name: 'annual_salary', type: 'float' },
        {name: 'salary_currency', type: 'string'},
        { name: 'effective_date', type: 'date' },
        { name: 'employer__name', type: 'string' },
          {name: 'has_noncompete', type:'bool'},
          {name: 'has_termination', type:'bool'},
          {name: 'url' , type: 'string'},
          {name: 'detail_url', type:'string'},
          {name: 'vacation_yearly', type:'string'}
      ];
      var menu_renderer = function(row, event) {
        var grid = $(event.currentTarget).parents('.jqxgrid');
        row = grid.jqxGrid('getrowdata', row);
        var menu_data = [
          {url: row.url,
            icon: 'fa fa-file-text-o',
            text: 'View Document'},
          {url: row.detail_url,
            icon: 'fa fa-user',
            text: 'View Employee'},
        ];
        show_menu(menu_data, grid, row.pk);
      };
      var columns = [
          { text: 'Name', datafield: 'document__name',
          align: 'center', cellsalign: 'left',
          cellsrenderer: defaultLinkFormatter, columngroup: 'Document' },
          { text: 'Type', datafield: 'document__document_type', width: 100,
          align: 'center', cellsalign: 'center', columngroup: 'Document' },
          { text: 'Employee', datafield: 'name', width: 150,
          align: 'center', cellsalign: 'left'},
          { text: 'Annual Salary', datafield: 'annual_salary',
          align: 'center', cellsalign: 'center', width: 100 },
          {text: 'Currency', datafield: 'salary_currency', width: 60, 
          align: 'center', cellsalign: 'center' },
          { text: 'Annual vacation', datafield: 'vacation_yearly',
          align: 'center', cellsalign: 'center', width: 100 },
          { text: 'Employer Name', datafield: 'employer__name', width: 200,
          align: 'center', cellsalign: 'center' },
          { text: 'Non-Compete', datafield: 'has_noncompete',
          width: 70,  columntype: 'checkbox', resizable: false, type: 'bool',
          align: 'center', cellsalign: 'center' },
          { text: 'Termination', datafield: 'has_termination',
          width: 70,  columntype: 'checkbox', resizable: false, type: 'bool',
          align: 'center', cellsalign: 'center' },
          {text: 'Effective Date', datafield: 'effective_date', width: 100,
          enabletooltips:true, align: 'center', cellsalign: 'center',
              format: 'yyyy-MM-dd', cellsformat: 'yyyy-MM-dd'},
          { text: 'Action', datafield: 'url', width: 60,
          align: 'center', exportable: false,
          columntype: 'button',
          sortable: false, filterable: false, menu: false,
          cellsrenderer: function(){return 'Menu'},
          buttonclick: menu_renderer }
      ];

      var custom_grid_options = {
        columngroups: [
          { text: 'Document', name: 'Document', align: 'center' }
        ]
      };
      draw_grid(".jqxgrid", datafields, columns, true, null, custom_grid_options);

    });
  </script>
{% endblock %}
